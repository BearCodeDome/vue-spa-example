
<template>
    <div class="layout">
        <Menu mode="horizontal" theme="dark" active-name="1" class="top-nav clearfix">
          <Row>
            <i-col class="layout-logo fl" span="5">XX管理系统</i-col>
            <i-col  class="layout-nav fr" span="8">
              <Row :gutter="10">
                <i-col span="7"> 
                  <Menu-item name="1">
                      <Icon type="ios-people"></Icon>
                      用户管理
                  </Menu-item>
                </i-col>
                <i-col span="8"> 
                  <Submenu name="3">
                      <template slot="title">
                          <Icon type="stats-bars"></Icon>
                          统计分析
                      </template>
                      <Menu-group title="使用">
                        <Menu-item name="3-1">1</Menu-item>
                        <Menu-item name="3-2">2</Menu-item>
                        <Menu-item name="3-3">3</Menu-item>
                      </Menu-group>
                      <Menu-group title="留存">
                        <Menu-item name="3-4">4</Menu-item>
                        <Menu-item name="3-5">5</Menu-item>
                      </Menu-group>
                  </Submenu>
                </i-col>
                <i-col span="7"> 
                  <Menu-item name="4">
                    <div class="user-infor-box">
                      <div class="user-pic fl"><img src="../static/img/user-pic.jpg" alt=""></div>
                      <div class="user-name fl">hgcoder</div>
                    </div>
                  </Menu-item>
                </i-col>
              </Row>
            </i-col>
          </Row>
        </Menu>
        <bread-cru></bread-cru>
        <div class="layout-content">
          <Row>
              <i-col :span="spanLeft" class="side" :class="{'smallNav':isSmall}">
                <Menu width="auto" :open-names="['1']" v-if="!isSmall">
                    <template v-for="item in navData">
                      <template v-if="item.list.length">
                        <Submenu :name="item.id">
                          <template slot="title">
                              <span>{{item.name}}</span>
                          </template>
                          <Menu-item :name="link.id" v-for="link in item.list" key="link">
                           <router-link :to="link.path" tag="span"><Icon :type="link.icon"></Icon> {{link.name}}</router-link>
                          </Menu-item>
                        </Submenu>
                      </template>
                      <template v-else>
                        <Menu-item :name="item.id">
                          <router-link :to="item.path" tag="span" class="linkList"><Icon :type="item.icon"></Icon> {{item.name}}</router-link>
                        </Menu-item>
                      </template>
                    </template>
                </Menu>
                <Menu v-else width="auto">
                  <Menu-item v-for="item in smaNav" key="item" :name="item.id">
                          <router-link :to="item.path" tag="span" class="linkList"><Icon :type="item.icon"></Icon></router-link>
                        </Menu-item>
                </Menu>
                <div class="switchNav" @click="switchNav"><Icon type="navicon"></Icon></div>
              </i-col>
              <i-col :span="spanRight">
                  <div class="layout-content-main main-cot">
                    <router-view></router-view>
                  </div>
              </i-col>
          </Row>
        </div>
        <div class="layout-copy">
          @copyRight
        </div>
    </div>
</template>

<script>
  // import {nav} from './store.js'
  import breadCru from './components/common/bread.vue'
  import { mapGetters } from 'vuex'
  export default {
    data () {
      return {
        colDt: 5,
        spanLeft: 5,
        spanRight: 19,
        isSmall: false,
        smaNav: [],
        activeNav: '1'
        // navData: nav.data.list || []
        // bread: nav.data.name || []
      }
    },
    components: {
      breadCru
    },
    computed: mapGetters([
      'count',
      'recentHistory',
      'tableData1',
      'tableData2',
      'navData'
    ]),
    methods: {
      switchNav () {
        this.spanLeft = this.spanLeft === 5 ? 1 : 5
        this.spanRight = this.spanRight === 19 ? 23 : 19
        if (this.spanLeft === 1) {
          this.isSmall = true
        } else {
          this.isSmall = false
        }
      }
    },
    created () {
      let arr = []
      this.$store.state.navData.list.map((index, ele) => {
        if (!index.path) {
          arr = arr.concat(index.list)
        } else {
          arr = arr.concat([index])
        }
      })
      this.smaNav = arr
    },
    mounted () {
    }
  }
</script>
<style lang="scss">
    .layout{
        background: #f5f7f9;
        height: 100%;
    }
    .layout-logo{
        width: 100px;
        height: 30px;
        line-height: 30px;
        color: #fff;
        text-align: center;
        border-radius: 3px;
        float: left;
        position: relative;
        top: 10px;
        left: 3px;
    }
    .layout-nav{
        margin: 0 auto;
    }
    .layout-assistant{
        width: 300px;
        margin: 0 auto;
        height: inherit;
    }
    .layout-breadcrumb{
        padding: 10px 15px 0;
    }
    .layout-content{
        min-height: 200px;
        margin: 15px;
        overflow: hidden;
        background: #fff;
    }
    .layout-content-main{
        padding: 10px;
    }
    .layout-copy{
        text-align: center;
        padding: 10px 0 20px;
        color: #9ea7b4;
    }
    .user-pic{
      width: 30px;
      height: 30px;
      margin-top: 10px;
      margin-right: 10px;
      border-radius:50%;
      overflow:hidden;
      img{
        width: 100%;

      }
    }
    ul.top-nav{
      height: 46px;
      line-height: 46px;
    }
    .c-tit{
      width: 90%;
      margin:20px auto 20px;
      font-size: 18px;
    }
    .t-wrap{
      width: 80%;
      margin: 0 auto;
    }
    .c-tit1{
      font-size: 14px;
      margin-bottom: 10px;
    }
    .side{
      height: 100%;
      position:relative;
    }
    .ivu-menu-item i{
      // float: left;
    }
    .ivu-menu-item span{
      display: block;
    }
    .smallNav .linkList{
      position:relative;
      left: -4px;
    }
    .main-cot{
      min-height: 400px;
    }
    .main-cot:before{
      content: '';
      display: block;
      width: 1px;
      height: 100%;
      background: #d7dde4;
      position: absolute;
      top: 0;
      bottom: 0;
      left: -1px;
      z-index: 1;
    }
    .switchNav{
      font-size: 28px;
      position:absolute;
      right: 0;
      top: 10px;
      right: 20px;
      top: 1px;
      z-index: 99;
      cursor: pointer;
      transition: 0.5s all;
    }
    .smallNav .switchNav{
      right: -38px;
    }
</style>
